---

title: - Downloading & Uploading functions for Models


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/data.loader.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/data.loader.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_huggingface_model_to_package_registry" class="doc_header"><code>write_huggingface_model_to_package_registry</code><a href="https://gitlab.memri.io/memri/pymemri/tree/prod/pymemri/data/loader.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_huggingface_model_to_package_registry</code>(<strong><code>project_name</code></strong>, <strong><code>model</code></strong>, <strong><code>version</code></strong>=<em><code>'0.0.1'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_model_to_package_registry" class="doc_header"><code>write_model_to_package_registry</code><a href="https://gitlab.memri.io/memri/pymemri/tree/prod/pymemri/data/loader.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_model_to_package_registry</code>(<strong><code>model</code></strong>, <strong><code>project_name</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="download_huggingface_model_for_project" class="doc_header"><code>download_huggingface_model_for_project</code><a href="https://gitlab.memri.io/memri/pymemri/tree/prod/pymemri/data/loader.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>download_huggingface_model_for_project</code>(<strong><code>project_path</code></strong>=<em><code>None</code></em>, <strong><code>files</code></strong>=<em><code>None</code></em>, <strong><code>download_if_exists</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_huggingface_model_for_project" class="doc_header"><code>load_huggingface_model_for_project</code><a href="https://gitlab.memri.io/memri/pymemri/tree/prod/pymemri/data/loader.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_huggingface_model_for_project</code>(<strong><code>project_path</code></strong>=<em><code>None</code></em>, <strong><code>files</code></strong>=<em><code>None</code></em>, <strong><code>download_if_exists</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="--Transformers-tests">- Transformers tests<a class="anchor-link" href="#--Transformers-tests"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSequenceClassification</span><span class="p">,</span> <span class="n">AutoTokenizer</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModel</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;distilroberta-base&quot;</span><span class="p">,</span> <span class="n">num_labels</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Some weights of the model checkpoint at distilroberta-base were not used when initializing RobertaForSequenceClassification: [&#39;lm_head.dense.bias&#39;, &#39;roberta.pooler.dense.bias&#39;, &#39;lm_head.bias&#39;, &#39;roberta.pooler.dense.weight&#39;, &#39;lm_head.decoder.weight&#39;, &#39;lm_head.layer_norm.weight&#39;, &#39;lm_head.dense.weight&#39;, &#39;lm_head.layer_norm.bias&#39;]
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at distilroberta-base and are newly initialized: [&#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.dense.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_model_to_package_registry</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;test-1234&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>writing config.json to package registry of test-1234 with project id 190
uploading /tmp/config.json
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='100' class='' max='100' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [100/100 00:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Succesfully uploaded /tmp/config.json
writing pytorch_model.bin to package registry of test-1234 with project id 190
uploading /tmp/pytorch_model.bin
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='100' class='' max='100' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [100/100 04:23<00:02]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Succesfully uploaded /tmp/pytorch_model.bin
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">load_huggingface_model_for_project</span><span class="p">(</span><span class="n">project_path</span><span class="o">=</span><span class="s2">&quot;memri/finetuning-example&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/Users/koen/.memri/projects/finetuning-example/config.json
downloading config.json from project memri/finetuning-example, package plugin-model-package
writing config.json to /Users/koen/.memri/projects/finetuning-example
/Users/koen/.memri/projects/finetuning-example/pytorch_model.bin
downloading pytorch_model.bin from project memri/finetuning-example, package plugin-model-package
writing pytorch_model.bin to /Users/koen/.memri/projects/finetuning-example
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">download_huggingface_model_for_project</span><span class="p">(</span><span class="n">project_path</span><span class="o">=</span><span class="s2">&quot;memri/finetuning-example&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">num_labels</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/Users/koen/.memri/projects/finetuning-example/config.json
/Users/koen/.memri/projects/finetuning-example/config.json already exists, and `download_if_exists`==False, using cached version
/Users/koen/.memri/projects/finetuning-example/pytorch_model.bin
/Users/koen/.memri/projects/finetuning-example/pytorch_model.bin already exists, and `download_if_exists`==False, using cached version
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

